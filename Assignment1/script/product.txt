SELECT
a.ITEM_SK,
MAX(b.PM_CAT_ENG_DESC) AS ITEM_CAT,
sum(SELLING_RETAIL_AMT) as TOTAL_REVENUE,
count(distinct TRANSACTION_RK) as BASKETS,
count(distinct CUSTOMER_SK) as DISTINCT_CUSTOMERS,
avg(SELLING_RETAIL_AMT/NULLIF(ITEM_QTY,0)) as AVERAGE_PRICE
FROM dataset01.sales219 a, dataset01.items b
WHERE a.ITEM_SK = b.ITEM_SK
GROUP BY a.ITEM_SK
ORDER BY TOTAL_REVENUE DESC

#1267 - Illegal mix of collations (utf8mb3_unicode_ci,IMPLICIT) and (utf8mb3_general_ci,IMPLICIT) for operation '='


SELECT
a.CUSTOMER_SK,
sum(SELLING_RETAIL_AMT) as TOTAL_REVENUE,
count(distinct TRANSACTION_RK) as BASKETS,
count(distinct a.CUSTOMER_SK) as DISTINCT_CUSTOMERS,
avg(SELLING_RETAIL_AMT/NULLIF(ITEM_QTY,0)) as AVERAGE_PRICE
FROM dataset01.sales219 a, dataset01.members b
WHERE a.CUSTOMER_SK = b.CUSTOMER_SK
GROUP BY a.CUSTOMER_SK
ORDER BY TOTAL_REVENUE DESC